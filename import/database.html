<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Data in existing databases | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../styles/website.css">
    

        
    
    
    <link rel="next" href="../import/files.html" />
    
    
    <link rel="prev" href="../import/dsn.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="2.2" data-chapter-title="Data in existing databases" data-filepath="import/database.md" data-basepath=".." data-revision="Tue Nov 24 2015 07:48:22 GMT-0600 (CST)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="db/main.html">
            
                
                    <a href="../db/main.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Use Cases
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="db/patron.html">
            
                
                    <a href="../db/patron.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Patron Snapshots
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="db/instruction.html">
            
                
                    <a href="../db/instruction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Library Instruction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="db/ezproxy.html">
            
                
                    <a href="../db/ezproxy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        EZproxy Logs
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="import/import.html">
            
                
                    <a href="../import/import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Importing Data
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="import/dsn.html">
            
                
                    <a href="../import/dsn.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Setting up your database
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="import/database.html">
            
                
                    <a href="../import/database.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Data in existing databases
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="import/files.html">
            
                
                    <a href="../import/files.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Data in files
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="appendix/a-python.html">
            
                
                    <a href="../appendix/a-python.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Appendix A - Installing Python Software
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="appendix/b-odbc.html">
            
                
                    <a href="../appendix/b-odbc.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Appendix B - Installing Access ODBC Drivers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="appendix/c-troubleshooting.html">
            
                
                    <a href="../appendix/c-troubleshooting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Appendix C - Troubleshooting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="appendix/d-database-basics.html">
            
                
                    <a href="../appendix/d-database-basics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Appendix D - Database Basics
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="importing-data-from-other-databases">Importing data from other databases</h1>
<p>A large amount of the data we&apos;re interested in analyzing is stored in databases other than the Access database we run our queries from.  To simplify the process of importing snapshots of that data into our Access database, we have a few import programs written in Python.  Each program is responsible for importing data from a single table, although that data may result in multiple records being created in different tables in our database.</p>
<h2 id="importing-new-data">Importing New Data</h2>
<p>The existing process for importing data involves generating an exported version of the table in Excel format, and then importing that data into the Access database.  To make the software easier to write and maintain, the Excel files are set up as linked tables in the Access database.</p>
<p><img src="../images/db-import-1.png" alt="Linked Excel Sheet"></p>
<p>To import a new spreadsheet, simple open up the Access database, right-click on the linked table, and select &quot;Linked Table Manager&quot; from the pop-up menu.</p>
<p><img src="../images/db-import-2.png" alt="Linked Table Manager"></p>
<p>Make sure the table you want to update has a check mark next to it, and that the &quot;Always prompt for new location&quot; checkbox at the bottom of the screen is ticked.  When you click &quot;Ok&quot;, a dialog box will pop up asking you for the location of the new file.</p>
<p>Once you&apos;ve updated all of the linked tables, save your Access database, and you&apos;re ready to run the import software.</p>
<p>If you always generate your database exports with the same name, and put them in the same location, you can skip this step.  Access will pick up any changes automatically.</p>
<h2 id="adding-your-own-linked-tables">Adding your own linked tables</h2>
<p>To add your own linked tables, click on the &quot;External Data&quot; tab at the top of the Access window.</p>
<p><img src="../images/external-data-1.png" alt="External Data"></p>
<p>You can select different data sources, including other Access databases, Excel files, or plain-text formats like CSV.  Once you click on the appropriate format, select &quot;Link to the data source by creating a linked table&quot;, and follow the rest of the wizard to set up your table.</p>
<p><img src="../images/linked-table-1.png" alt="Linked Table"></p>
<h2 id="importing-patron-data">Importing Patron Data</h2>
<p>The Patron data exports include fields that are stored in several different tables in our database design.  There&apos;s the Patron table itself, with the patron&apos;s ID number, their barcode, and their group and status.  There&apos;s also information about the department they belong to.  Since the department information can change over time, we also need to update the table linking patron and department.</p>
<p>The import software handles all of this for you, but you need to be aware of a few things.  </p>
<p>Firstly, the departments present at an institution are automatically detected during the process of importing patrons.  This means if there are any misspelled departments, a duplicate department entry with a misspelled name will be generated.  This kind of thing can be hard to detect, but it may show up in reports, so if you see something that looks strange in a report, that&apos;s a possible reason.  If the PAT_DEPARTMENT field in the source table is used for notes (as we&apos;ve seen at some institutions) that can generate erroneous departments as well.</p>
<p>Secondly, because we&apos;re tracking department membership over time by using changes between snapshots, the order in which snapshots are imported does matter (in computer science, we say that the import operation is &quot;not idempotent&quot;), so make sure you&apos;re importing snapshots in the order they were generated.  Multiple records for a single patron in a single snapshot can also cause erroneous department changes to show up.</p>
<p>Lastly, you can run the import software with the database open in Access, but you need to make sure none of the tables have unsaved changes, and that none of them are open in design view.  In both of these cases, the import software will generate an error message.  If this happens, just save any changes, close any tabs open to design view, and re-run the software.</p>
<h2 id="importing-instruction-data">Importing Instruction Data</h2>
<p>Since the Instruction table simply indicates the date on which a patron received instruction, it will accept duplicate data.  Running the same import step will result in duplicate data being inserted.</p>
<h2 id="importing-patron-snapshots">Importing Patron Snapshots</h2>
<p>Patron snapshots can be inserted a maximum of once a day.  The ingest software will automatically detect duplicates, so it is safe to run the same import several times.  The order of the imports does not matter, since the instruction date is included in the source data.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../import/dsn.html" class="navigation navigation-prev " aria-label="Previous page: Setting up your database"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../import/files.html" class="navigation navigation-next " aria-label="Next page: Data in files"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
